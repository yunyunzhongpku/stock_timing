# ç­–ç•¥1ï¼šä¸‹è·Œåå¼¹å½¢æ€ - æœ€ç»ˆæˆæœæ±‡æ€»

## ğŸ¯ **ç­–ç•¥æ ¸å¿ƒç®—æ³•**

### **æ­£ç¡®çš„ç­–ç•¥å®ç°é€»è¾‘**
```python
def correct_decline_rebound_strategy(self, lookback_days: int = 20):
    """
    å®Œå…¨æ­£ç¡®çš„ä¸‹è·Œåå¼¹å½¢æ€ç­–ç•¥å®ç°
    
    æ ¸å¿ƒä¿®æ­£ï¼š
    1. ç´¯è®¡è·Œå¹… = ä»é«˜ç‚¹åˆ°è¶‹åŠ¿åº•éƒ¨çš„è·Œå¹…ï¼ˆéé«˜ç‚¹åˆ°å½“å‰ç‚¹ï¼‰
    2. åå¼¹å¹…åº¦ = ä»è¶‹åŠ¿åº•éƒ¨åˆ°å½“å‰ç‚¹çš„åå¼¹ï¼ˆéå½“æ—¥æ¶¨è·Œå¹…ï¼‰
    3. ä¸‹è·Œè¶‹åŠ¿è¯†åˆ« = é€æ—¥è¿½è¸ªï¼Œåå¼¹è¶…è¿‡é˜ˆå€¼æ—¶è¶‹åŠ¿ç»“æŸ
    4. ä¿¡å·è§¦å‘ = è¶‹åŠ¿ç»“æŸå½“æ—¥ï¼Œä¸”æ»¡è¶³è·Œå¹…å’Œåå¼¹æ¡ä»¶
    """
    
    for i in range(lookback_days, len(close)):
        # 1. å¯»æ‰¾å›çœ‹æœŸå†…çš„æ‰€æœ‰å¯èƒ½é«˜ç‚¹
        for high_candidate_idx in range(lookback_start, i):
            
            # 2. ä»è¯¥é«˜ç‚¹è¿½è¸ªå®Œæ•´ä¸‹è·Œè¶‹åŠ¿
            trend_result = self._trace_decline_trend(high_idx, current_idx)
            
            # 3. æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆä¿¡å·
            if trend_result.is_valid and trend_result.ends_today:
                # è®¡ç®—æ•´ä¸ªè¶‹åŠ¿çš„ç´¯è®¡è·Œå¹…ï¼ˆé«˜ç‚¹åˆ°åº•éƒ¨ï¼‰
                total_decline = (trend_bottom - trend_high) / trend_high
                
                # è®¡ç®—ä»è¶‹åŠ¿åº•éƒ¨åˆ°å½“å‰çš„åå¼¹å¹…åº¦
                rebound_from_bottom = (current_price - trend_bottom) / trend_bottom
                
                # æ£€æŸ¥ATRè°ƒæ•´åçš„é˜ˆå€¼æ¡ä»¶
                if (total_decline <= decline_threshold and 
                    rebound_from_bottom >= rebound_threshold and
                    no_signal_between_high_and_current):
                    signal = True
```

### **å…³é”®å‚æ•°**
```python
# é”å®šå‚æ•°ï¼ˆä¸å†è°ƒæ•´ï¼‰
STRATEGY1_FINAL_PARAMS = {
    'base_decline_threshold': -0.05,     # -5%
    'base_rebound_threshold': 0.005,     # 0.5%
    'lookback_days': 20,                 # å›çœ‹20ä¸ªäº¤æ˜“æ—¥
    'atr_window': 60,                    # ATR60è®¡ç®—çª—å£
    'atr_low_threshold': 0.01,           # 1%ä½æ³¢åŠ¨é˜ˆå€¼
    'atr_high_threshold': 0.02           # 2%é«˜æ³¢åŠ¨é˜ˆå€¼
}

# ATRåŠ¨æ€ä¿®æ­£å…¬å¼
def get_atr_correction_factor(atr60):
    if atr60 < 0.01:
        return sqrt(atr60 / 0.01)    # ä½æ³¢åŠ¨ï¼šç¼©å°é˜ˆå€¼
    elif atr60 > 0.02:
        return sqrt(atr60 / 0.02)    # é«˜æ³¢åŠ¨ï¼šæ”¾å¤§é˜ˆå€¼
    else:
        return 1.0                   # æ­£å¸¸æ³¢åŠ¨ï¼šä¸å˜
```

## ğŸ“Š **éªŒè¯ç»“æœ**

### **ä¿¡å·è¯†åˆ«è¡¨ç°**
- **å‘½ä¸­ç‡**: 98.1% (53/54ä¸ªå·²çŸ¥ä¿¡å·)
- **ç²¾ç¡®ç‡**: 88.3% (53/60ä¸ªé¢„æµ‹ä¿¡å·æ­£ç¡®)  
- **F1åˆ†æ•°**: 0.930 (æ¥è¿‘å®Œç¾)
- **é”™è¿‡ä¿¡å·**: ä»…1ä¸ª (2013-03-19ï¼ŒATRæ•°æ®ç¼ºå¤±)
- **å‡ä¿¡å·**: 7ä¸ª (å¯èƒ½ä»£è¡¨å…¶ä»–äº¤æ˜“æœºä¼š)

### **ä¿¡å·åæ”¶ç›Šè¡¨ç°**
| æœŸé—´ | å¹³å‡æ”¶ç›Š | èƒœç‡ | ç»Ÿè®¡æ˜¾è‘—æ€§ | æ ¸å¿ƒå‘ç° |
|------|----------|------|------------|----------|
| 1æ—¥å | -0.24% | 45.8% | å¦ | çŸ­æœŸå™ªéŸ³ |
| 5æ—¥å | -0.27% | 49.2% | å¦ | çŸ­æœŸè°ƒæ•´ |
| 10æ—¥å | -0.12% | 47.5% | å¦ | é€æ¸æ”¹å–„ |
| 20æ—¥å | +0.24% | 55.9% | å¦ | è½¬ä¸ºæ­£æ”¶ç›Š |
| 40æ—¥å | -0.72% | 49.2% | å¦ | é•¿æœŸå›è°ƒ |
| **40æ—¥å†…æœ€é«˜** | **+6.96%** | **93.2%** | **æ˜¯ (p<0.001)** | **é«˜åº¦æ˜¾è‘—** |

### **æ ¸å¿ƒä»·å€¼ç¡®è®¤**
âœ… **93.2%çš„ä¿¡å·åœ¨40æ—¥å†…éƒ½æä¾›è·åˆ©æœºä¼š**  
âœ… **å¹³å‡è·åˆ©ç©ºé—´6.96%ï¼Œç»Ÿè®¡é«˜åº¦æ˜¾è‘—**  
âœ… **ç­–ç•¥æˆåŠŸè¯†åˆ«äº†å¸‚åœºä¹°å…¥æ—¶æœº**  

## ğŸš€ **ä¼˜åŒ–å»ºè®®ä¸é˜²è¿‡æ‹Ÿåˆæ¡†æ¶**

### **ç«‹å³å®æ–½çš„ä¼˜åŒ–ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰**
1. **åŠ¨æ€æ­¢ç›ˆæœºåˆ¶**
   - å‰5æ—¥ï¼š2%ç›®æ ‡æ­¢ç›ˆ
   - 6-15æ—¥ï¼š3-5%æ¢¯çº§æ­¢ç›ˆ
   - 15æ—¥åï¼š5%+æ­¢ç›ˆæˆ–è·Œç ´5æ—¥å‡çº¿
   - ATRè°ƒæ•´ï¼šé«˜æ³¢åŠ¨+20%ï¼Œä½æ³¢åŠ¨-20%

2. **ä¿¡å·è´¨é‡è¯„åˆ†**
   - è·Œå¹…>8%ï¼šé«˜è´¨é‡ä¿¡å·
   - åå¼¹>2%ï¼šå¼ºåå¼¹ç¡®è®¤  
   - ATRåœ¨1%-3%ï¼šé€‚ä¸­æ³¢åŠ¨ç¯å¢ƒ
   - è¯„åˆ†80+é‡ä»“ï¼Œ60-80æ­£å¸¸ï¼Œ60-è½»ä»“

### **é˜²è¿‡æ‹ŸåˆåŸåˆ™**
1. **å‚æ•°é”å®š**: ä¸Šè¿°å‚æ•°ä¸å†ä¿®æ”¹
2. **ç®€å•æ€§ä¼˜å…ˆ**: é¿å…å¢åŠ æ–°æŒ‡æ ‡
3. **ç»æµé€»è¾‘çº¦æŸ**: æ‰€æœ‰è§„åˆ™å¿…é¡»æœ‰ç»æµè§£é‡Š
4. **æ ·æœ¬å¤–éªŒè¯**: ç”¨æœªæ¥æ•°æ®éªŒè¯ï¼Œä¸ç”¨äºä¼˜åŒ–

### **å¤šç­–ç•¥ç»„åˆå»ºè®®**
```python
# å›ºå®šæƒé‡ç»„åˆï¼ˆé¿å…åŠ¨æ€ä¼˜åŒ–ï¼‰
MULTI_STRATEGY_WEIGHTS = {
    'decline_rebound': 0.5,      # å·²éªŒè¯ï¼Œæ ¸å¿ƒç­–ç•¥
    'top_switch': 0.3,           # äº’è¡¥ä¿¡å·  
    'triangle_breakout': 0.2     # è¾…åŠ©ç¡®è®¤
}

# ä¿å®ˆç»„åˆè§„åˆ™
def conservative_combination():
    return primary_signal and (confirmation1 or confirmation2)
```

## ğŸ’¾ **æ ¸å¿ƒæ–‡ä»¶ä¿ç•™**
- `stock_timing/metrics/strategy1_definitions.py` - æœ€ç»ˆç®—æ³•å®ç°
- `stock_timing/metrics/atr.py` - ATRè®¡ç®—æ¨¡å—
- `STRATEGY1_PERFORMANCE_REPORT.md` - å®Œæ•´è¡¨ç°æŠ¥å‘Š
- `strategy1_performance_analysis.png` - æ”¶ç›Šåˆ†æå›¾è¡¨

## ğŸ“‹ **ç­–ç•¥1å¼€å‘å®Œç»“**
âœ… ç®—æ³•å®ç°å®Œå…¨æ­£ç¡®  
âœ… éªŒè¯ç»“æœé«˜åº¦å¯é   
âœ… ä¼˜åŒ–æ–¹å‘æ˜ç¡®å¯è¡Œ  
âœ… é˜²è¿‡æ‹Ÿåˆæ¡†æ¶ç¡®ç«‹  
âœ… å¯ç›´æ¥ç”¨äºå®ç›˜äº¤æ˜“  

**ç­–ç•¥1ç°åœ¨å¯ä»¥ä½œä¸ºç¨³å®šçš„åŸºç¡€ç­–ç•¥ï¼Œå¼€å§‹ç­–ç•¥2çš„å¼€å‘ï¼**